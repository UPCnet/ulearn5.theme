$.urlParam=function(e){var i=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return!!i&&i[1]},$(document).ready(function(){setTimeout(function(){$(".userSearch").select2({allowClear:!0,placeholder:" ",minimumInputLength:3,ajax:{url:portal_url+"/ulearn.ajaxusersearch",data:function(e,i){return{q:e,page:i}},results:function(e,i){return e}},initSelection:function(e,i){var r=$(e).val();$.ajax(portal_url+"/ulearn.fromusername2displayname",{data:{q:r}}).done(function(e){i(e)})}})},100),$.urlParam("user")?($(".typeSearch").val("user"),$(".communityBlock").hide(),$(".add_favorite").hide(),$(".userBlock").show()):$.urlParam("idcommunity")?($(".typeSearch").val("community"),$(".communityBlock").show(),$(".add_favorite").show(),$(".userBlock").hide(),$(".communitySearch").val($.urlParam("idcommunity"))):($(".typeSearch").val("user"),$(".communityBlock").hide(),$(".add_favorite").hide(),$(".userBlock").show()),$(".typeSearch").on("change",function(){var e=$(this).val();"user"==e?($(".communityBlock").hide(),$(".add_favorite").hide(),$(".userBlock").show()):("community"==e?($(".communityBlock").show(),$(".add_favorite").show()):($(".communityBlock").hide(),$(".add_favorite").hide()),$(".userBlock").hide())}),$(".searchFilters input.search").on("click",function(){var e=$(".typeSearch").val(),i=window.location.href.replace("#/","");if(index=i.indexOf("?"),-1!=index&&(i=i.substring(0,index)),"user"==e){var r=$(".userSearch").select2("val");0<r.length&&(window.location=i+"?user="+r)}else"community"==e?window.location=i+"?idcommunity="+$(".communitySearch").val():"all"==e&&(i=i.split("/users_communities")[0],window.open(i+"/gestion/exports/export_users_communities.csv/@@download/file/export_users_communities.csv","_blank"))}),$(".searchFilters input.add_favorite").on("click",function(){var e=$(".typeSearch").val(),i=window.location.href.replace("#/","");if(index=i.indexOf("?"),-1!=index&&(i=i.substring(0,index)),"community"==e){i=i.split("/users_communities")[0];var r=$(".communitySearch").val();$.ajax({type:"get",url:i+"/addcommunityasfavoritefromallusers",data:{community:r},success:function(e){alertify.success("Set favorite from all users.")},error:function(e){alertify.error("Error to set favorite in community.")}})}})});